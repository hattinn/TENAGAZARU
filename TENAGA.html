<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>tenagazaru_play</title>
	<link rel="stylesheet" href="destyle.css">
	<link rel="stylesheet" href="style.css">
</head>

<body>

<div id="game-wrap" class="game-wrap">
	<canvas id="can-head" class="can-head"></canvas>
	<div id="play-wrap" class="play-wrap">
		<canvas id="can-play" class="can-play"></canvas>
		<canvas id="can-bg" class="can-bg bgi_01"></canvas>
	</div>
	<div id="button-wrap" class="button-wrap">
		<button id="left" class="left"></button>
		<button id="right" class="right"></button>
	</div>
</div>

<audio id="bgm_01"    src="sound/bgm_01.mp3" autoplay></audio>
<audio id="se_move"   src="sound/move.mp3"></audio>
<audio id="se_banana" src="sound/banana.mp3"></audio>
<audio id="se_unti"   src="sound/unti.mp3"></audio>


<script src="data.js"></script>
<script>
/*--------------------共通設定-----------------------------------*/
// let window_size = window.innerWidth;
// const BLOCK_SIZE = window_size/10;

//音

let bgm_01  		 = document.getElementById("bgm_01");   /*BGM01*/
let se1_move 		 = document.getElementById("se_move");  /*サルの移動の音  */
let se2_banana   = document.getElementById("se_banana");/*バナナゲット音*/
let se3_unti  	 = document.getElementById("se_unti");  /*うんち登場の音  */

let bgm = bgm_01;/*BGM初期値*/



//フィールドサイズ
const FIELD_COL = 10;
const FIELD_ROW = 20;

//ブロック一つのサイズ
const BLOCK_SIZE_W = 108;
const BLOCK_SIZE_H =  96;

//スクリーンサイズ
const SCREEN_W = BLOCK_SIZE_W * FIELD_COL;
const SCREEN_H = BLOCK_SIZE_H * FIELD_ROW;


//ロープの設定
const ROPE_W = SCREEN_W;		/*長さ*/
const ROPE_H = SCREEN_W/25; /*厚み*/
const ROPE_X = 0;						/*x座標*/
const ROPE_Y = SCREEN_H/2 - BLOCK_SIZE_H*2;/*y座標*/



//-----------------------サルの設定---------------------------
/*サルの画像タイプ*/
let saruType =
[
	/*     平常心,          叫び,      ダウン*/
	["saru_open_2x"    ,"saru_open_s_2x"    ,"saru_open_d_2x"   ],/*[0]腕を開く*/
	["saru_open_l_2x"  ,"saru_open_s_l_2x"  ,"saru_open_d_l_2x" ],/*[0]腕を開く(左向き)*/
	["saru_close_2x"   ,"saru_close_s_2x"   ,"saru_close_d_2x"  ],/*[1]腕を閉じる*/
	["saru_close_l_2x" ,"saru_close_s_l_2x" ,"saru_close_d_l_2x"] /*[1]腕を閉じる(左向き)*/
]

const SARU_SPEED = BLOCK_SIZE_W;			/*サルの移動幅*/
const SARU_W = BLOCK_SIZE_W*4;			  /*横幅*/
const SARU_H = BLOCK_SIZE_H*6;			  /*縦幅*/
const START_X = SCREEN_W/2 - SARU_W/2;/*スタート位置x*/
const START_Y = ROPE_Y - 10;					/*スタート位置y*/
let   saru_x = START_X;								/*サルの現在位置x*/
let   saru_y = START_Y;          			/*サルの現在位置y*/
let   saru_t = saruType[0][0];			 	/*サルのタイプ(初期値)*/



//----------------ゲームヘッダーの設定-----------------------
let canHead = document.getElementById("can-head");
let ctxHead = canHead.getContext("2d");
ctxHead.imageSmoothingEnabled = false;/*画質改善*/
/*キャンバスサイズ*/
canHead.width  = SCREEN_W;
canHead.height = SCREEN_H/5;
/*ハートの位置(横、左から順)*/
const HEART_POSITION_X_1 = BLOCK_SIZE_W * 3;  /*1.(画面左から順)*/
const HEART_POSITION_X_2 = BLOCK_SIZE_W * 3.8;/*2.*/
const HEART_POSITION_X_3 = BLOCK_SIZE_W * 4.6;/*3.*/
const HEART_POSITION_X_4 = BLOCK_SIZE_W * 5.4;/*4.*/
const HEART_POSITION_X_5 = BLOCK_SIZE_W * 6.2;/*5.*/
/*ハートの位置(縦)*/
const HEART_POSITION_Y   = BLOCK_SIZE_H - (BLOCK_SIZE_H * 2)/4;/*縦位置*/

/*ハートの種類*/
let heartType = ["heart_00_2x","heart_2x"]/*[0]が器,[1]がハート*/
let heart_t = heartType[1];


// heart_00.onload = function()
// { ctxHead.drawImage(heart_00_2x, HEART_POSITION_X_1, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
//   ctxHead.drawImage(heart_00_2x, HEART_POSITION_X_2, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
//   ctxHead.drawImage(heart_00_2x, HEART_POSITION_X_3, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
//   ctxHead.drawImage(heart_00_2x, HEART_POSITION_X_4, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
//   ctxHead.drawImage(heart_00_2x, HEART_POSITION_X_5, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
// }



//----------------背景の設定----------------------------------
let canBg   = document.getElementById("can-bg");
// let ctxBg	 = canBg.getContext("2d");
/*キャンバスサイズ*/
canBg.width  = SCREEN_W;
canBg.height = SCREEN_H;

//----------------プレイ画面の設定----------------------------
let canPlay   = document.getElementById("can-play");
let ctxPlay	 = canPlay.getContext("2d");
ctxPlay.imageSmoothingEnabled = false;/*画質改善*/
/*キャンバスサイズ*/
canPlay.width  = SCREEN_W;
canPlay.height = SCREEN_H;


//***********↑↑基本設定ココまで↑↑*********************************************

/////////////////////ヘッダー////////////////////////



/////////////////////プレイ画面////////////////////////



function draw(){
	if(saru_t == saruType[0][0])
	{
		saru_t = saruType[0][1];
		ctxPlay.drawImage( saru_close_2x, saru_x, saru_y, SARU_W, SARU_H );
	}else if(saru_t == saruType[0][1])
	{
		saru_t = saruType[0][0];
		ctxPlay.drawImage( saru_open_2x, saru_x, saru_y, SARU_W, SARU_H );
	}
}
//----------------操作処理--------------------------------
// let lbutton   = document.getElementById("left");

//キーボードが押された時の処理
document.onkeydown = function(e)
{
	// bgm.currentTime = 0;
	// bgm.play();
	// if(over)return;
	if( e.keyCode == 37 )
	{
		ctxPlay.clearRect(saru_x,saru_y, SARU_W, SARU_H );
		ctxPlay.drawImage( rope_2x, ROPE_X, ROPE_Y, ROPE_W, ROPE_H );
		saru_x -=SARU_SPEED;
		draw();
		se_banana.currentTime = 0;
		se_banana.play();
		// if( checkMove( -1, 0 ) )
	}else if( e.keyCode == 39){
		ctxPlay.clearRect(saru_x,saru_y, SARU_W, SARU_H );
		ctxPlay.drawImage( rope_2x, ROPE_X, ROPE_Y, ROPE_W, ROPE_H );
		saru_x +=SARU_SPEED;
		draw();
		se_banana.currentTime = 0;
		se_banana.play();
		// if( checkMove(  1, 0 ) )
	}
}

init();

function init()
{
	//サルを初期化
	saru_open_2x.onload = function()
	{ctxPlay.drawImage( saru_open_2x, saru_x, saru_y, SARU_W, SARU_H );}
	
	//ロープを初期化
	rope_2x.onload = function()
	{
		ctxPlay.drawImage( rope_2x, ROPE_X, ROPE_Y, ROPE_W, ROPE_H );
	}
	
	//サルアイコンを初期化
	icon_01_2x.onload = function()
	{
		ctxHead.drawImage(icon_01_2x, BLOCK_SIZE_W - (BLOCK_SIZE_W * 2)/3, BLOCK_SIZE_H - (BLOCK_SIZE_H * 2)/4, BLOCK_SIZE_W * 2.6, BLOCK_SIZE_H * 2.6);
	}
	//ハートを初期化
	heart_2x.onload = function()
	{
		ctxHead.drawImage(heart_2x, HEART_POSITION_X_1, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
	  ctxHead.drawImage(heart_2x, HEART_POSITION_X_2, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
	  ctxHead.drawImage(heart_2x, HEART_POSITION_X_3, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
	  ctxHead.drawImage(heart_2x, HEART_POSITION_X_4, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
	  ctxHead.drawImage(heart_2x, HEART_POSITION_X_5, HEART_POSITION_Y, BLOCK_SIZE_W, BLOCK_SIZE_H);
	}
	//サルの位置を初期化
	saru_x = START_X;
	saru_y = START_Y;
}

</script>
</body>
</html>